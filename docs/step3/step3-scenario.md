# Step3 시나리오  
## 요구사항  
* [x] 지하철 노선 생성 시 필요한 인자 추가하기
* [x] 지하철 노선에 구간을 등록하는 기능 구현
* [x] 지하철 노선에 구간을 제거하는 기능 구현
* [x] 지하철 노선에 등록된 구간을 통해 역 목록을 조회하는 기능 구현
* [x] 구간 등록 / 제거 시 예외 케이스에 대한 인수 테스트 작성
  
### 지하철 노선 생성 시 필요한 인자 추가하기   

* 노선 생성 시 두 종점역(상행 종점, 하행 종점) 추가한다.(Long 타입 stationId 사용)   
* 두 종점역 간의 거리 인자도 함께 받아서 생성하게 한다.(int 타입 distance 사용)     
* 인수 테스트와 DTO 등 수정이 필요함   
   
### 지하철 노선에 구간을 등록하는 기능 구현    
  
* 새로운 구간의 상행역은 해당 노선에 등록되어있는 하행 종점역이어야 한다.     
* 새로운 구간의 하행역은 해당 노선에 등록되어있는 역일 수 없다.  

### 지하철 노선에 구간을 제거하는 기능 구현

* 지하철 노선에 등록된 역(하행 종점역)만 제거할 수 있다. 즉, 마지막 구간만 제거할 수 있다.
* 지하철 노선에 상행 종점역과 하행 종점역외 여러개가 있는 경우역을 삭제할 수 있다.

### 지하철 노선에 등록된 구간을 통해 역 목록을 조회하는 기능 구현

* 지하철 노선 조회 시 등록된 역 목록을 함께 응답
* 노선에 등록된 구간을 순서대로 정렬하여 상행 종점부터 하행 종점까지 목록을 응답하기

## 구간 등록 / 제거 시 예외 케이스에 대한 인수 테스트 작성

### 노선 생성시 

* 상행 종점역 == 기존 역이 없다면 생성이 실패한다.    
* 하행 종점역 == 기존 역이 없다면 생성이 실패한다.    

### 노선 구간 등록시 

* 새로운 구간의 상행역이 하행 종점역이 아니면 구간 등록에 실패한다.    
* 새로운 구간의 하행역이 해당 노선에 등록되어있는 역이면 실패한다.    

### 누선 구간 제거시 
    
* 지하철 노선에 등록된 역이 하행 종점역이 아니면 제거할 수 있다. 즉, 마지막 구간이 아니면 제거할 수 없다.        
* 지하철 노선에 상행 종점역과 하행 종점역만 있는 경우(구간이 1개인 경우) 역을 삭제할 수 없다.  

### 구간을 통해 역 목록 조회
* 지하철 노선 조회 시 등록된 역 목록을 함께 응답
* 노선에 등록된 구간을 순서대로 정렬하여 상행 종점부터 하행 종점까지 목록을 응답하기

# 시나리오  
## 지하철 역 관리 기능 
```properties
Feature: 지하철역 관리 기능
    Scenario: 지하철역 생성
      When 지하철역 생성을 요청 하면
      Then 지하철역 생성이 성공한다.

    Scenario: 중복 이름으로 지하철역 생성
      Given 지하철역 생성을 요청 하고
      When 같은 이름으로 지하철역 생성을 요청 하면
      Then 지하철역 생성이 실패한다.
    
    Scenario: 공백 이름으로 지하철역 생성
      When 공백 색깔을 가진 지하철역 생성을 요청 하면
      Then 지하철역 생성이 실패한다.

    Scenario: 지하철 역 목록 조회
      Given 지하철역 생성을 요청 하고
      Given 새로운 지하철역 생성을 요청 하고
      When 지하철역 목록 조회를 요청 하면
      Then 두 지하철역이 포함된 지하철역 목록을 응답받는다
 
    Scenario: 지하철 역 삭제
      Given 지하철역 생성을 요청 하고
      When 생성한 지하철역 삭제를 요청 하면
      Then 생성한 지하철역 삭제가 성공한다. 
```

## 지하철 노선 관리 기능 
```properties
Feature: 지하철 노선 관리 기능
    Scenario: 지하철 노선 생성
   🥕 Given 지하철역(상행) 생성을 요청 하고
   🥕 And 새로운 지하철역(하행) 생성을 요청 하고
      When 지하철 노선 생성을 요청 하면
      Then 지하철 노선 생성이 성공한다.

 🥕 Scenario: 지하철 역이 없는 상태에서 지하철 노선 생성
      When 지하철 노선 생성을 요청 하면
      Then 지하철 노선 생성이 실패한다.

    Scenario: 중복 이름으로 지하철 노선 생성
      Given 지하철 노선 생성을 요청 하고
      When 같은 이름으로 지하철 노선 생성을 요청 하면
      Then 지하철 노선 생성이 실패한다.
    
    Scenario: 중복 색깔로 지하철 노선 생성
      Given 지하철 노선 생성을 요청 하고
      When 같은 색깔로 지하철 노선 생성을 요청 하면
      Then 지하철 노선 생성이 실패한다.

    Scenario: 지하철 노선 목록 조회
      Given 지하철 노선 생성을 요청 하고
      And 새로운 지하철 노선 생성을 요청 하고
      When 지하철 노선 목록 조회를 요청 하면
      Then 두 노선이 포함된 지하철 노선 목록을 응답받는다
 
    Scenario: 지하철 노선 조회  
      Given 지하철 노선 생성을 요청 하고  
      When 생성한 지하철 노선 조회를 요청 하면  
      Then 생성한 지하철 노선을 응답받는다(구간이랑 역정보도)  

    Scenario: 지하철 노선 수정
      Given 지하철 노선 생성을 요청 하고
      When 지하철 노선의 정보 수정을 요청 하면
      Then 지하철 노선의 정보 수정은 성공한다.

    Scenario: 지하철 노선 삭제
      Given 지하철 노선 생성을 요청 하고
      When 생성한 지하철 노선 삭제를 요청 하면
      Then 생성한 지하철 노선 삭제가 성공한다.
```

## 구간 관리 

```properties
🥕 Feature: 지하철 노선 구간 관리 기능

    Scenario: 지하철 노선 구간 등록
      Given 지하철 노선 생성을 요청 하고
      When 지하철 노선에 새로운 구간 추가 요청을 하면
      Then 지하철 노선에 새로운 구간이 등록된다.

    Scenario: 하행 종점이 아닌 상행역으로 지하철 노선 구간 등록
      Given 지하철 노선 생성을 요청 하고
      When 하행 종점이 아닌 상행역으로 새로운 구간 등록 요청을 하면
      Then 지하철 노선에 새로운 구간 추가가 실패한다.

    Scenario: 하행역이 이미 존재하는 역인 상태로 지하철 노선 구간 추가
      Given 지하철 노선 생성을 요청 하고
      When 하행역이 이미 존재하는 역인 상태로 새로운 구간 등록 요청을 하면
      Then 지하철 노선에 새로운 구간 추가가 실패한다.

    Scenario: 지하철 노선 구간 제거
      Given 지하철 노선 생성을 요청 하고
      And 지하철 노선 구간을 등록하고
      When 지하철 노선 마지막 구간 제거 요청을 하면
      Then 지하철 노선 구간이 제거된다.

    Scenario: 지하철 노선 중간 구간 제거
      Given 지하철 노선 생성을 요청 하고
      And 지하철 노선 구간을 등록하고
      And 새로운 지하철 노선 구간을 등록하고
      When 지하철 노선 중간 구간 제거 요청을 하면
      Then 지하철 노선 구간 제거에 실패한다.

    Scenario: 지하철 노선 단일 구간일 때 구간 제거
      Given 지하철 노선 생성을 요청 하고
      When 지하철 노선 구간 제거 요청을 하면
      Then 지하철 노선 구간 제거에 실패한다.
```
